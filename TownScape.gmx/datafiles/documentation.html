<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>readme.html</title>
  <meta name="generator" content="Haroopad 0.12.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF) repeat scroll 0 0 transparent;background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:medium none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:medium none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:medium none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:none no-repeat scroll 5px -27px #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:none repeat scroll 0 0 #FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:none repeat scroll 0 0 #EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:none repeat scroll 0 0 #75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:#1A3C6C solid 1px;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-bottom-width:0;border-left-width:0;border-right-width:0;border-top-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;max-width:none;min-height:0;outline-color:#112644;outline-style:none;outline-width:0;overflow-x:visible;overflow-y:visible;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;border:0 none;color:#ccc;height:3px;padding:0}hr.underscore{border:0 none!important;height:30px;padding:0;-webkit-margin-before:0;-webkit-margin-after:0}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:#fff url(../img/ajax.gif) no-repeat center center}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}.markdown{padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-break:break-all;word-wrap:break-word}.markdown pre{border-radius:3px;word-break:break-all;word-wrap:break-word;overflow:auto}.markdown pre code{display:block}.markdown pre>code{border:1px solid #ccc;white-space:pre;padding:.5em;margin:0}.markdown code{border-radius:3px;word-break:break-all;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown table{padding:0;border-collapse:collapse;border-spacing:0}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.markdown em.underline{font-style:normal;text-decoration:underline}.markdown strong.highlight{color:#000;padding:0 5px;background-color:#fdffb6;-webkit-box-shadow:#fdffb6 0 0 5px;-moz-box-shadow:#fdffb6 0 0 5px;box-shadow:#fdffb6 0 0 5px}@import url(http://fonts.googleapis.com/css?family=Tauri);import url(http://fonts.googleapis.com/css?family=Roboto+Condensed:300italic,400italic,700italic,400,300,700);.haroopad{padding:20px;color:#222;font-size:15px;font-family:'Roboto Condensed',Tauri,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",AppleSDGothicNeo-Medium,'Segoe UI','Malgun Gothic',Verdana,Tahoma,sans-serif;background:#fff;-webkit-font-smoothing:antialiased}.haroopad a{color:#3269a0}.haroopad a:hover{color:#4183c4}.haroopad h2{border-bottom:1px solid #e6e6e6;line-height:1.7em}.haroopad h6{color:#777}.haroopad hr{border:1px solid #e6e6e6}.haroopad blockquote>code,.haroopad h1>code,.haroopad h2>code,.haroopad h3>code,.haroopad h4>code,.haroopad h5>code,.haroopad h6>code,.haroopad li>code,.haroopad p>code,.haroopad td>code{color:#000;background-color:#feecdd;border:1px solid #efdfd0}.haroopad pre>code{font-size:1em;font-family:Consolas,Inconsolata,Courier,monospace;letter-spacing:-1px;font-weight:700}.haroopad blockquote{border-left:4px solid #e6e6e6;padding:0 15px;color:#777}.haroopad table{background-color:#fafafa}.haroopad table tr td,.haroopad table tr th{border:1px solid #e6e6e6}.haroopad table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;padding:.5em;background:#fdf6e3;color:#657b83}.diff .hljs-header,.hljs-comment,.hljs-doctype,.hljs-javadoc,.hljs-pi,.hljs-template_comment,.lisp .hljs-string{color:#93a1a1}.css .hljs-tag,.hljs-addition,.hljs-keyword,.hljs-request,.hljs-status,.hljs-winutils,.method,.nginx .hljs-title{color:#859900}.hljs-command,.hljs-hexcolor,.hljs-link_url,.hljs-number,.hljs-phpdoc,.hljs-regexp,.hljs-rules .hljs-value,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#2aa198}.css .hljs-function,.hljs-built_in,.hljs-chunk,.hljs-decorator,.hljs-id,.hljs-identifier,.hljs-localvars,.hljs-title,.vhdl .hljs-literal{color:#268bd2}.haskell .hljs-type,.hljs-attribute,.hljs-class .hljs-title,.hljs-constant,.hljs-link_reference,.hljs-parent,.hljs-variable,.lisp .hljs-body,.smalltalk .hljs-number{color:#b58900}.clojure .hljs-title,.css .hljs-pseudo,.diff .hljs-change,.hljs-attr_selector,.hljs-cdata,.hljs-header,.hljs-pragma,.hljs-preprocessor,.hljs-preprocessor .hljs-keyword,.hljs-shebang,.hljs-special,.hljs-subst,.hljs-symbol,.hljs-symbol .hljs-string{color:#cb4b16}.hljs-deletion,.hljs-important{color:#dc322f}.hljs-link_label{color:#6c71c4}.tex .hljs-formula{background:#eee8d5}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown haroopad">

  <h1 id="happytear-text-engine"><a name="happytear-text-engine" href="#happytear-text-engine"></a>HappyTear Text Engine</h1><p><strong>Version 0.9.3 — EARLY ACCESS</strong><br>This is an early access build. Upcoming changes might break your own commands and display styles</p><h2 id="table-of-contents"><a name="table-of-contents" href="#table-of-contents"></a>Table of Contents</h2><ol>
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#Howtouse">How to use</a><ol>
<li><a href="#Setup">Setup</a></li>
<li><a href="#Basicusage">Basic usage [Example]</a></li>
<li><a href="#Moredemos">More demos</a></li>
</ol>
</li>
<li><a href="#Advancedconfiguration">Advanced configuration</a><ol>
<li><a href="#textvariabledefaults">Changing defaults of text variables</a></li>
<li><a href="#lockingplayer">Locking the player</a></li>
<li><a href="#playerinput">Configuring player input</a></li>
<li><a href="#textnext">Change the textnext sprites</a></li>
</ol>
</li>
<li><a href="#Builtindisplaystyles">Builtin display styles</a></li>
<li><a href="#Builtintextcommands">Builtin text commands</a></li>
<li><a href="#Builtinglobalvariables">Builtin global variables</a></li>
<li><a href="#Builtintextvariables">Builtin text variables</a></li>
<li><a href="#AdvancedUse">Even more advanced configuration</a><ol>
<li><a href="#MultiplayerSetup">Multiplayer Setup</a></li>
<li><a href="#Surfaces">Don’t use a surface for drawing: Use something else</a></li>
</ol>
</li>
<li><a href="#Extending">Extending the HappyTear Text Engine</a><ol>
<li><a href="#Owncommand">Own commands</a></li>
<li><a href="#Owndisplaystyle">Own display style</a></li>
<li><a href="#Ownvariables">Own variables</a></li>
<li><a href="#builtinvariables">Reference: Builtin internal variables</a></li>
<li><a href="#textvars">Reference: textvars diagram</a></li>
<li><a href="#Debugging">Debugging</a></li>
</ol>
</li>
<li><a href="#Issues">Common issues</a><ol>
<li>Supported platforms</li>
<li>Android: Demo project controls aren’t working correctly</li>
<li>Linux: Demo project: Strange display issue when starting the demo</li>
<li>I’m getting some weird error when starting the conversation</li>
</ol>
</li>
<li><a href="#Support">Issue tracker / Support</a></li>
</ol><h1 id="1-introduction"><a name="1-introduction" href="#1-introduction"></a><a name="Introduction"></a>1. Introduction</h1><p>Welcome! Thank’s for choosing the <strong>HappyTear Text Engine</strong>. brought to you by Marco aka. Parakoopa, lead programmer at Happy Tear Studios.</p><p>With this Engine you can create simple and yet powerful and great looking textboxes and textbubbles. The whole Engine is constructed around <strong>conversations</strong> which is a set of <strong><a href="#Builtintextcommands">text commands</a></strong> and <strong><a href="#Builtintextvariables">text variables</a></strong> that are used to display <strong>textboxes</strong>. Each instance can have unlimited conversations. The look of the displayed textbox is determined by it’s <strong><a href="#Builtindisplaystyles">display style</a></strong> which can be changed using the text commands.</p><h1 id="2-how-to-use"><a name="2-how-to-use" href="#2-how-to-use"></a><a name="Howtouse"></a>2. How to use</h1><h2 id="2-1-setup"><a name="2-1-setup" href="#2-1-setup"></a><a name="Setup"></a>2.1. Setup</h2><p>Before doing anything you should play the demo project to get a feel of the engine.</p><p>Then we need some <strong>fonts</strong>. The text engine needs at least one font. The basic name of that can be changed in the engine as explained by “<a href="#textvariabledefaults">Changing defaults of text variables</a>“. The default is <strong>fnt_speach</strong>. You can simply copy the fonts in the demo project and adjust them to your needs.<br><strong>Each font needs:</strong></p><ul>
<li>A default version of the font named <em>yourfontname</em></li>
<li>Bold and italic versions of that font called  <em>yourfontname_bold</em> and  <em>yourfontname_italic</em></li>
<li>A version that is both italic and bold called  <em>yourfontname_bold_italic</em></li>
<li>A small version of all the above called  <em>yourfontname_small</em>,  <em>yourfontname_small_bold</em>…</li>
</ul><p>You also optionally need <strong>textnext-Sprites</strong>. These are used to display a sprite when we wait for player input (see the manual of wait input under <a href="#Builtintextcommands">chapter 5</a> for more information on that or see the demos). You can simply choose your own sprites for that or import the demo project sprites and modify them.<br>How the list of textnext sprites can be changed it explained <a href="#textnext">here</a>.</p><p>After that’s done, before you can start using the Happy Tear Text Engine in your project, you have to set it up first. Open the script <code>text_setup</code>.<br>Follow the descriptions of the settings and adjust them according to your needs.<br>The important variables to change are:</p><ul>
<li><code>global.text_local_player</code>: needs to be changed to be your player object if you have a singleplayer game or your player instance if you want to have a multiplayer game with textbox syncing. When you have a singleplayer game this variable isn’t that critical. If you don’t have a player in your game set it to some kind of controlling object.</li>
<li><code>var base_width</code> and <code>var base_height</code> in <code>text_resize_surfaces</code>: When using the default drawing, which is drawing on a surface (see <a href="#Surfaces">8.2.</a> you probably want to adjust those so that they are smaller if your game resolution is not full hd. Take your width if it’s bigger than your height and insert it as base_width. Calculate the 16:9 counterpart of your width and insert that as a height. Do the opposite if your height is bigger than your width. <strong>The ratio of the variables has to be 16/9</strong>.</li>
</ul><p>Okay, so now we are done with setup. Create an object that will control the text engine. In it’s <strong>create</strong> event call <code>text_setup();</code>, in the <strong>step</strong> event <code>text_update();</code> and in the <strong>draw event</strong> <code>text_draw();</code>.</p><p>Cool! You can now start creating texts.</p><h2 id="2-2-basic-usage-example-"><a name="2-2-basic-usage-example-" href="#2-2-basic-usage-example-"></a><a name="Basicusage"></a>2.2. Basic usage [Example]</h2><p>To create a <strong>conversation</strong> you need an instance which controls the text. You have to have some kind of trigger which creates the text. See the demo project for some more help on that (See <a href="#Moredemos">2.3</a>).</p><p>This is the most basic way to create a simple conversation which displays a textbox at the top:</p><pre><code class="gml hljs" data-origin="&lt;pre&gt;&lt;code class=&quot;gml&quot;&gt;var commands = ds_list_create();
text_add_command(commands,&quot;show&quot;);
text_add_command(commands,&quot;line&quot;,&quot;This is a basic example of the&quot;);
text_add_command(commands,&quot;line&quot;,&quot;HappyTear Text Engine.&quot;);
text_add_command(commands,&quot;wait_input&quot;);
text_add_command(commands,&quot;close&quot;);
text(commands,0);
&lt;/code&gt;&lt;/pre&gt;">var commands = ds_list_create();
text_add_command(commands,"show");
text_add_command(commands,"line","This is a basic example of the");
text_add_command(commands,"line","HappyTear Text Engine.");
text_add_command(commands,"wait_input");
text_add_command(commands,"close");
text(commands,0);
</code></pre><p><strong>Please check out <a href="#Moredemos">the other demos</a> for commented code and more complex examples!</strong><br>To check if the conversation is running you use the command <code>text_get_state(id)</code> in our case that’s <code>text_get_state(0)</code>. It will return <strong>0</strong> if the conversation was not create or it’s state was reset, <strong>-1</strong> when the conversation is running and <strong>1</strong> when the conversation has finished and it’s state has not been reset.</p><p>After the conversation is ready reset it’s state using <code>text_reset_state(id)</code>. This frees up memory. After that text_get_state will return 0 again so you have to save it’s state. See demo 12 for how you can implement that.</p><h2 id="2-3-more-demos"><a name="2-3-more-demos" href="#2-3-more-demos"></a><a name="Moredemos"></a>2.3. More demos</h2><p>The demo project contains very useful demos on how to master the HappyTear Text Engine.</p><p>All demos can be found in the folder <em>scripts/Text Engine/demos</em>. In the demo project there are also objects that control these demo conversations. For demos like demo 12 the actual “demo” is included in this object.</p><p>Here’s a full list of demos. They should be read in order:</p><ol>
<li><code>text_demo1_simple</code> - controlled by obj_text_demo<br>Contains a basic introduction to the HappyTear Text Engine, fully commented and functional.</li>
<li><code>text_demo2_animations</code> - controlled by obj_text_demo<br>Shows you how to control text speed, use wait_time and how you can stop the text in the middle of a line using nolines.</li>
<li><code>text_demo3_pointing</code> - controlled by obj_text_demo<br>Introduces you to the <em>pointing</em> display style. Also explains what display styles are and how to add a nameplate to a text.</li>
<li><code>text_demo4_multiple</code> - controlled by obj_text_demo<br>Shows you how to control multiple textboxes in one conversation.</li>
<li><code>text_demo5_lock</code> - controlled by obj_text_demo<br>Shows you how you can lock the player during a conversation. <strong>Note: Requires that <em>global.text_local_player</em> was correctly configured and your player can be locked as described in <a href="#lockingplayer">chapter 3.2. “Locking the player”</a>.</strong></li>
<li><code>text_demo6_bubble</code> - controlled by obj_text_demo<br>Introduces you to the display style that made you buy this text engine: <em>bubble</em></li>
<li><code>text_demo7_color</code> - controlled by obj_text_demo_walkby<br>Learn how to color everything. Also shows you how to use fonts and how to make text bold and italic. Oh! And background images…<br>This demo also shows via obj_text_demo_walkby how you can create text that simply triggers by walking by.</li>
<li><code>text_demo8_manual</code> - controlled by obj_text_demo<br>Shows you how to manually place textboxes.</li>
<li><code>text_demo9_disappear</code> - controlled by obj_text_demo<br>Configure a conversation so it automatically ends when walking too far away.</li>
<li><code>text_demo10_multi1</code> and </li>
<li><code>text_demo11_multi2</code> - controlled by obj_text_multi<br>Demos that you can also add multiple conversations to one instance</li>
<li><code>text_demo12_onlyonce</code> - controlled by obj_text_onlyonce<br>Shows you via obj_text_onlyonce how to memorize that the conversation is over.</li>
</ol><h1 id="3-advanced-configuration"><a name="3-advanced-configuration" href="#3-advanced-configuration"></a><a name="Advancedconfiguration"></a>3. Advanced configuration</h1><h2 id="3-1-changing-defaults-of-text-variables"><a name="3-1-changing-defaults-of-text-variables" href="#3-1-changing-defaults-of-text-variables"></a><a name="textvariabledefaults"></a>3.1. Changing defaults of text variables</h2><p>Let’s  be honest. The default look of the HappyTear Text Engine is probably not what you expected. It’s ugly. Well we did that on purpose. It’s your job to choose some nice default options.<br>And I will show you how to do that!</p><p>Before we start with the text variables, please note that there are some <strong>global</strong> variables in <code>text_setup</code> that control things like the rounding of the box-edges and the distance you have to walk when enabling <em>disappear</em>. You probably want to change some of them.</p><p>Now to the defaults of the text variables. In <a href="#Builtintextvariables">chapter 7</a> you can find a list of text variables if you want to know what each of it does and what the default setting is.</p><p>To change the defaults open the script <em>scripts/Text Engine/configuration/</em><code>text_create_conversation</code>. This script contains a list of statements looking like this:  </p><pre><code class="gml hljs" data-origin="&lt;pre&gt;&lt;code class=&quot;gml&quot;&gt;ds_map_add(argument0, &quot;display&quot;, &quot;banner&quot;);
&lt;/code&gt;&lt;/pre&gt;">ds_map_add(argument0, "display", "banner");
</code></pre><p>Well I think it’s actually pretty obvious how to change the default settings, isn’t it? This line shows that the <em>display</em> variable has the value <em>banner</em> as a default. You can change <em>banner</em> to be any valid display style.</p><p>Just do the same for the rest of the variables and you have successfully customized the HappyTear Text Engine. You can also add new variables here. More details on that can be found in chapter <a href="##Ownvariables">9.3 “Own variables”</a>.</p><h2 id="3-2-locking-the-player"><a name="3-2-locking-the-player" href="#3-2-locking-the-player"></a><a name="lockingplayer"></a>3.2. Locking the player</h2><p>When locking the player with the <code>lock_player</code> <a href="#builtintextcommands">text command</a> the variable <code>lock</code> on the player instance defined in <code>global.text_local_player</code> will be set to true. Use this variable to prevent the player from moving when locked.</p><h2 id="3-3-configuring-player-input"><a name="3-3-configuring-player-input" href="#3-3-configuring-player-input"></a><a name="playerinput"></a>3.3. Configuring player input</h2><p>Thee script <em>scripts/Text Engine/configuration/</em><code>text_action_pressed</code> returns true or false depending on whether or not the player has pressed a button to proceed the text [used by text command <code>wait_input</code>. </p><p>Study the script and change it to include your way of checking for text progression.</p><p>By default it looks something like this (no comments):</p><pre><code class="gml hljs" data-origin="&lt;pre&gt;&lt;code class=&quot;gml&quot;&gt;if (argument_count &amp;gt; 0) var conv = argument0;
else var conv = noone;
if (!global.text_pressed &amp;amp;&amp;amp; keyboard_check_pressed(vk_space)) {
    global.text_pressed = true;
    return true;
}
else return false;
&lt;/code&gt;&lt;/pre&gt;">if (argument_count &gt; 0) var conv = argument0;
else var conv = noone;
if (!global.text_pressed &amp;&amp; keyboard_check_pressed(vk_space)) {
    global.text_pressed = true;
    return true;
}
else return false;
</code></pre><p><em>global.text_pressed</em> is used to make sure this can only return true once a step. See the <a href="#Builtinglobalvariables">chapter on global variables</a> for more information.</p><p>You can simply change <em>vk_space</em> to another button to… use another button or add your own logic to the if-clause. Please note that you have to make some more configuration when doing multiplayer as explained in the script and in <a href="#MultiplayerSetup">chapter 8.1. “Multiplayer Setup”</a>.</p><h2 id="3-4-change-the-textnext-sprites"><a name="3-4-change-the-textnext-sprites" href="#3-4-change-the-textnext-sprites"></a><a name="textnext"></a>3.4. Change the textnext sprites</h2><p>The <strong>textnext-Sprites</strong> are the sprites that inform the player that he has to press a button to proceed the text. They are used by the text command <code>wait_input</code>. If you want to change the sprites or add your own open the script <em>scripts/Text Engine/configuration/</em><code>text_wait_input_textnext</code>.</p><p>There is a switch in there. Each case of this script corresponds to one <em>textnext index</em> that is used with <em>wait_input</em>. Change the return values of the first two cases or add your own for additional sprites.</p><h1 id="4-builtin-display-styles"><a name="4-builtin-display-styles" href="#4-builtin-display-styles"></a><a name="Builtindisplaystyles"></a>4. Builtin display styles</h1><p><strong><em>NOTE:</em></strong> <em>The display style can be changed via the <a href="#Builtintextvariables">text variable</a> display.</em></p><h3 id="-banner-"><a name="-banner-" href="#-banner-"></a><code>banner</code></h3><p><strong>DEFAULT</strong></p><p><strong>Description:</strong><br>Displays a huge textbox at the top or bottom of the screen. Shows three rows be default and expands if more rows are added.<br><code>manual_x</code> has to be 0 when manual mode is enabled.<br>Do not remove this display style, it’s the parent of all display styles.</p><p><strong>Specific text variables:</strong><br><code>position</code></p><h3 id="-pointing-"><a name="-pointing-" href="#-pointing-"></a><code>pointing</code></h3><p><strong>Description:</strong><br>Same as banner + displays an arrow that points at <code>instance</code>.</p><p><strong>Specific text variables:</strong><br><code>position</code>,<code>instance</code></p><h3 id="-bubble-"><a name="-bubble-" href="#-bubble-"></a><code>bubble</code></h3><p><strong>Description:</strong><br>Displays a small text bubble that will adjust to the size of the text and follow <code>instance</code> while pointing at it. It will avoid other bubbles via collision detection.<br>On manual mode this does not point at instance, is placed at a fixed position and no collision checking is done.</p><p><strong>Specific text variables:</strong><br><code>instance</code></p><h1 id="5-builtin-text-commands"><a name="5-builtin-text-commands" href="#5-builtin-text-commands"></a><a name="Builtintextcommands"></a>5. Builtin text commands</h1><p><strong><em>NOTE:</em></strong> <em>To see how commands are added to a conversation see the <a href="#Basicusage">basic usage</a></em>.</p><h3 id="-set-"><a name="-set-" href="#-set-"></a><code>set</code></h3><p><strong>Description:</strong><br>Change the value of a <a href="#Builtintextvariable">text variable</a>.</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">variable</td>
<td style="text-align:left">string</td>
<td style="text-align:left">the name of the text variable to change</td>
</tr>
<tr>
<td style="text-align:left">value</td>
<td style="text-align:left">{depends on var.}</td>
<td style="text-align:left">The value that should be assigned to the variable.</td>
</tr>
</tbody>
</table><h3 id="-show-"><a name="-show-" href="#-show-"></a><code>show</code></h3><p><strong>Description:</strong><br>Open a new textbox. All variables that are configured to be copied to the textbox will now be copied and applied to the new textbox.</p><p><strong>No arguments.</strong></p><h3 id="-close-"><a name="-close-" href="#-close-"></a><code>close</code></h3><p><strong>Description:</strong><br>Closes a textbox or the last opened textbox if no argument is given.</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">[textbox offset]</td>
<td style="text-align:left">real</td>
<td style="text-align:left">The offset of the textbox. 0 for the current one, 1 for the box before that… <em>Optional</em></td>
</tr>
</tbody>
</table><h3 id="-line-"><a name="-line-" href="#-line-"></a><code>line</code></h3><p><strong>Description:</strong><br>Adds new text to the specified textbox or the last opened textbox if no textbox is specified. Adds a new line before adding the text.</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">text</td>
<td style="text-align:left">string</td>
<td style="text-align:left">The string of text to add</td>
</tr>
<tr>
<td style="text-align:left">[textbox offset]</td>
<td style="text-align:left">real</td>
<td style="text-align:left">The offset of the textbox. 0 for the current one, 1 for the box before that… <em>Optional</em></td>
</tr>
</tbody>
</table><h3 id="-noline-"><a name="-noline-" href="#-noline-"></a><code>noline</code></h3><p><strong>Description:</strong><br>Adds new text to the specified textbox or the last opened textbox if no textbox is specified. Adds NO newline. The text gets added to the current line.</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">text</td>
<td style="text-align:left">string</td>
<td style="text-align:left">The string of text to add</td>
</tr>
<tr>
<td style="text-align:left">[textbox offset]</td>
<td style="text-align:left">real</td>
<td style="text-align:left">The offset of the textbox. 0 for the current one, 1 for the box before that… <em>Optional</em></td>
</tr>
</tbody>
</table><h3 id="-wait_input-"><a name="-wait_input-" href="#-wait_input-"></a><code>wait_input</code></h3><p><strong>Description:</strong><br>Wait for player input. The player input is checked using the script <code>text_action_pressed</code>. Both arguments are optional. The first one can be used to display a <strong>textnext</strong>-Sprite. A textnext sprite will be displayed in the bottom right corner of the textbox to show the player that we are waiting for input. If not specified, no textnext Sprite will be shown. The argument is an index number. This index numbers is passed to <code>text_wait_input_textnext</code>. If a textnext is specified, the textbox in argument 2 will be used to display the sprite. If argument2 is not given it will be shown in the last textbox.</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">[textnext sprite index]</td>
<td style="text-align:left">real</td>
<td style="text-align:left">The index number of a textnext sprite to show. If not specified no textnext will be shown. <em>Optional</em></td>
</tr>
<tr>
<td style="text-align:left">[textbox offset]</td>
<td style="text-align:left">real</td>
<td style="text-align:left">The offset of the textbox. 0 for the current one, 1 for the box before that… <em>Optional</em></td>
</tr>
</tbody>
</table><h3 id="-wait_time-"><a name="-wait_time-" href="#-wait_time-"></a><code>wait_time</code></h3><p><strong>Description:</strong><br>Wait for x seconds before continuing with the next command.</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">time</td>
<td style="text-align:left">real</td>
<td style="text-align:left">The time to wait in seconds</td>
</tr>
</tbody>
</table><h3 id="-next_page-"><a name="-next_page-" href="#-next_page-"></a><code>next_page</code></h3><p><strong>Description:</strong><br>Removes all lines from the specified [or last] textbox.</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">[textbox offset]</td>
<td style="text-align:left">real</td>
<td style="text-align:left">The offset of the textbox. 0 for the current one, 1 for the box before that… <em>Optional</em></td>
</tr>
</tbody>
</table><h3 id="-bold-"><a name="-bold-" href="#-bold-"></a><code>bold</code></h3><p><strong>Description:</strong><br>Alias for set(“bold”)</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">[bold?]</td>
<td style="text-align:left">boolean</td>
<td style="text-align:left">true activates boldness for the next lines and nolines, false disables it. If not specified it will be activated. <em>Optional</em></td>
</tr>
</tbody>
</table><h3 id="-italic-"><a name="-italic-" href="#-italic-"></a><code>italic</code></h3><p><strong>Description:</strong><br>Alias for set(“italic”)</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">[italic?]</td>
<td style="text-align:left">boolean</td>
<td style="text-align:left">true activates italic…ness for the next lines and onlines, false disables it. If not specified it will be activated. <em>Optional</em></td>
</tr>
</tbody>
</table><h3 id="-color-"><a name="-color-" href="#-color-"></a><code>color</code></h3><p><strong>Description:</strong><br>Alias for set(“color”)</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">color</td>
<td style="text-align:left">color (real)</td>
<td style="text-align:left">The color to change the text color to</td>
</tr>
</tbody>
</table><h3 id="-font-"><a name="-font-" href="#-font-"></a><code>font</code></h3><p><strong>Description:</strong><br>Alias for set(“font”)</p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">font</td>
<td style="text-align:left">string</td>
<td style="text-align:left">The font. As a string. It has to be the base name of the font. See the bold variable for more info.</td>
</tr>
</tbody>
</table><h3 id="-reset_formatting-"><a name="-reset_formatting-" href="#-reset_formatting-"></a><code>reset_formatting</code></h3><p><strong>Description:</strong><br>“Resets” boldness, color, and italic. <em>Note: It doesn’t actually set color back to the specified default right now. It set’s it to c_black</em>.</p><p><strong>No arguments.</strong></p><h3 id="-lock_player-"><a name="-lock_player-" href="#-lock_player-"></a><code>lock_player</code></h3><p><strong>Description:</strong><br>Lock the player. Or unlock him. Depends on the argument. Please see chapter “<a href="#lockingplayer">Locking the player</a>“ for more info.<br><em>Note: This is global. Changing this in one conversation can overwrite the setting in another one.</em></p><p><strong>Arguments:</strong></p><table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:left">data type</th>
<th style="text-align:left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">lock?</td>
<td style="text-align:left">boolean</td>
<td style="text-align:left">Lock or unlock player</td>
</tr>
</tbody>
</table><h3 id="-kill-"><a name="-kill-" href="#-kill-"></a><code>kill</code></h3><p><strong>Description:</strong><br><em>Internal command. Do not use this. It silently removes the conversation.</em></p><p><strong>No arguments.</strong></p><h3 id="-none-"><a name="-none-" href="#-none-"></a><code>none</code></h3><p><strong>Description:</strong><br><em>Internal command. Do not use this. It executes no code and is never over (the next command will never execute; the conversation is stuck)</em></p><p><strong>No arguments.</strong></p><h1 id="6-builtin-global-variables"><a name="6-builtin-global-variables" href="#6-builtin-global-variables"></a><a name="Builtinglobalvariables"></a>6. Builtin global variables</h1><p><em>This list follows with an upcoming update. All global variables starting with text are reserved for this Text Engine.</em></p><h1 id="7-builtin-text-variables"><a name="7-builtin-text-variables" href="#7-builtin-text-variables"></a><a name="Builtintextvariables"></a>7. Builtin text variables</h1><p><strong><em>NOTE:</em></strong> <em>All text variables are set using the <code>set</code> <a href="#Builtintextcommands">text command</a>.</em></p><h3 id="-display-"><a name="-display-" href="#-display-"></a><code>display</code></h3><p><strong>Description:</strong><br>The current display style. <a href="#Builtindisplaystyles">List of display styles</a></p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>“banner” (string)</p><p><strong>Valid values:</strong><br>“banner”, “pointing”, “bubble” <em>(and all user defined display styles)</em></p><h3 id="-position-"><a name="-position-" href="#-position-"></a><code>position</code></h3><p><strong>Description:</strong><br>The position of the banner and poitning display styles in automatic mode.</p><p><strong>Applies to:</strong><br>All new created banner or pointing textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>“top” (string)</p><p><strong>Valid values:</strong><br>“top”, “bottom”</p><h3 id="-manual-"><a name="-manual-" href="#-manual-"></a><code>manual</code></h3><p><strong>Description:</strong><br>Enables or disables manual mode. Each display style handles manual mode different, so see the <a href="#Builtindisplaystyles">list of display styles</a> for more information.</p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>false (boolean)</p><p><strong>Valid values:</strong><br>true/false</p><h3 id="-manual_x-"><a name="-manual_x-" href="#-manual_x-"></a><code>manual_x</code></h3><p><strong>Description:</strong><br>X position of the textboxes in manual mode</p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>0 (real)</p><p><strong>Valid values:</strong><br>real values (numbers)</p><h3 id="-manual_y-"><a name="-manual_y-" href="#-manual_y-"></a><code>manual_y</code></h3><p><strong>Description:</strong><br>Y position of the textboxes in manual mode</p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>0 (real)</p><p><strong>Valid values:</strong><br>real values (numbers)</p><h3 id="-instance-"><a name="-instance-" href="#-instance-"></a><code>instance</code></h3><p><strong>Description:</strong><br>The instance this bubble or pointing follows.<br><em>NOTE: This does not apply to the disappear variable which uses the calling instance. This variable is only for presentation purposes.</em></p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br><code>global.text_local_player</code> (real/instance)</p><p><strong>Valid values:</strong><br>instance numbers/objects (real values)</p><h3 id="-name-"><a name="-name-" href="#-name-"></a><code>name</code></h3><p><strong>Description:</strong><br>The name to show in the nameplate or “false” (string!) if no nameplate should be shown.</p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>“false”</p><p><strong>Valid values:</strong><br>strings</p><h3 id="-disappear-"><a name="-disappear-" href="#-disappear-"></a><code>disappear</code></h3><p><strong>Description:</strong><br>If set to true, the conversation will end when the player is <code>global.text_distance</code> pixels away from the <em>instance that created this conversation</em>.</p><p><strong>Applies to:</strong><br>The whole conversation</p><p><strong>Default:</strong><br>false (boolean)</p><p><strong>Valid values:</strong><br>false/true</p><h3 id="-animation-"><a name="-animation-" href="#-animation-"></a><code>animation</code></h3><p><strong>Description:</strong><br>Enables or disabled character animations. If true, new lines and nolines get displayed instantly.</p><p><strong>Applies to:</strong><br>The whole conversation</p><p><strong>Default:</strong><br>false (boolean)</p><p><strong>Valid values:</strong><br>false/true</p><h3 id="-speed-"><a name="-speed-" href="#-speed-"></a><code>speed</code></h3><p><strong>Description:</strong><br>The text speed</p><p><strong>Applies to:</strong><br>The whole conversation</p><p><strong>Default:</strong><br>4 (real)</p><p><strong>Valid values:</strong><br>real values (numbers)</p><h3 id="-bold-"><a name="-bold-" href="#-bold-"></a><code>bold</code></h3><p><strong>Description:</strong><br>If true, new lines and nolines are printed bold, if false not.</p><p><strong>Applies to:</strong><br>All new created lines and nolines. Does not affect old text.</p><p><strong>Default:</strong><br>false (boolean)</p><p><strong>Valid values:</strong><br>false/true</p><h3 id="-italic-"><a name="-italic-" href="#-italic-"></a><code>italic</code></h3><p><strong>Description:</strong><br>If true, new lines and nolines are printed italic, if false not.</p><p><strong>Applies to:</strong><br>All new created lines and nolines. Does not affect old text.</p><p><strong>Default:</strong><br>false (boolean)</p><p><strong>Valid values:</strong><br>false/true</p><h3 id="-font-"><a name="-font-" href="#-font-"></a><code>font</code></h3><p><strong>Description:</strong><br>The base name of the font. Please note that to this font name, “_bold”, “_italic”, “_bold_italic”, “_small_bold”,… could be appended. See the <a href="#Setup">setup chapter</a> for more information on that.</p><p><strong>Applies to:</strong><br>All new created lines and nolines. Does not affect old text.</p><p><strong>Default:</strong><br>“fnt_speach” (string)</p><p><strong>Valid values:</strong><br>strings that represent a series of font assets</p><h3 id="-color-"><a name="-color-" href="#-color-"></a><code>color</code></h3><p><strong>Description:</strong><br>Controls text color for new text</p><p><strong>Applies to:</strong><br>All new created lines and nolines. Does not affect old text.</p><p><strong>Default:</strong><br>c_black (color/real)</p><p><strong>Valid values:</strong><br>colors (real)</p><h3 id="-bgcolor-"><a name="-bgcolor-" href="#-bgcolor-"></a><code>bgcolor</code></h3><p><strong>Description:</strong><br>Background color of new created textboxes</p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>c_white (color/real)</p><p><strong>Valid values:</strong><br>colors (real)</p><h3 id="-bgalpha-"><a name="-bgalpha-" href="#-bgalpha-"></a><code>bgalpha</code></h3><p><strong>Description:</strong><br>The alpha of the background color. This does NOT apply to the background image.</p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>1 (real)</p><p><strong>Valid values:</strong><br>A real between 0 and 1</p><h3 id="-bgimage-"><a name="-bgimage-" href="#-bgimage-"></a><code>bgimage</code></h3><p><strong>Description:</strong><br>The background image of the textbox or <code>noone</code> if no background should be used. The background image get’s drawn behind the background color, so you have to lower the alpha of the background color with <em>bgalpha</em>.</p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>noone (-1/real)</p><p><strong>Valid values:</strong><br>real values that represent background assets or noone</p><h3 id="-bgcolor_nameplate-"><a name="-bgcolor_nameplate-" href="#-bgcolor_nameplate-"></a><code>bgcolor_nameplate</code></h3><p><strong>Description:</strong><br>The background color of the nameplate</p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>c_white (color/real)</p><p><strong>Valid values:</strong><br>colors/real</p><h3 id="-color_nameplate-"><a name="-color_nameplate-" href="#-color_nameplate-"></a><code>color_nameplate</code></h3><p><strong>Description:</strong><br>The text color of the nameplate</p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>c_black (color/real)</p><p><strong>Valid values:</strong><br>colors/real</p><h3 id="-font_nameplate-"><a name="-font_nameplate-" href="#-font_nameplate-"></a><code>font_nameplate</code></h3><p><strong>Description:</strong><br>The font to use on the nameplate. Please see the <code>font</code> variable for more information on the value.</p><p><strong>Applies to:</strong><br>All new created textboxes. Does not affect already opened textboxes.</p><p><strong>Default:</strong><br>“fnt_speach” (string)</p><p><strong>Valid values:</strong><br>strings that represent a series of font assets</p><h3 id="-room-"><a name="-room-" href="#-room-"></a><code>room</code></h3><p><strong>Description:</strong><br>The room this conversation is in. Textboxes only get displayed when you are in the same room as they are. Changing this variable will transfer all textboxes to another room.</p><p><strong>Applies to:</strong><br>Whole conversation</p><p><strong>Default:</strong><br><code>room</code> (real/room id)</p><p><strong>Valid values:</strong><br>a valid room index (real)</p><h1 id="8-even-more-advanced-configuration"><a name="8-even-more-advanced-configuration" href="#8-even-more-advanced-configuration"></a><a name="AdvancedUse"></a>8. Even more advanced configuration</h1><h2 id="8-1-multiplayer-setup"><a name="8-1-multiplayer-setup" href="#8-1-multiplayer-setup"></a><a name="MultiplayerSetup"></a>8.1. Multiplayer Setup</h2><p><em>An explanation on how to use this engine in multiplayer will be added in an upcoming update</em></p><h2 id="8-2-don-t-use-a-surface-for-drawing-use-something-else"><a name="8-2-don-t-use-a-surface-for-drawing-use-something-else" href="#8-2-don-t-use-a-surface-for-drawing-use-something-else"></a><a name="Surfaces"></a>8.2. Don’t use a surface for drawing: Use something else</h2><p><em>An explanation on how to change the drawing behavior of the HappyTear Text Engine will follow in an upcoming update.</em></p><h1 id="9-extending-the-happytear-text-engine"><a name="9-extending-the-happytear-text-engine" href="#9-extending-the-happytear-text-engine"></a><a name="Extending"></a>9. Extending the HappyTear Text Engine</h1><p>Extending the HappyTear Text Engine is easy. The engine uses a plug and play extension system using <em>script_execute</em> that allows you to simply create new scripts for commands and display styles.</p><p>Please note that the engine was originally created to fit our needs.<br>If you have trouble extending it please contact us!</p><h2 id="9-1-own-commands"><a name="9-1-own-commands" href="#9-1-own-commands"></a><a name="Owncommands"></a>9.1. Own commands</h2><p>Before you can start changing or adding a command you have to understand how the engine works internally. You have to have a basic understanding of ds_lists and ds_maps.  </p><p>All conversations are stored in <code>global.textvars</code>.<br>Each <strong>conversation</strong> ds_map has a key <em>“__texts”</em>. This key contains a ds_list which contains a <strong>list of textboxes</strong>. In this list each entry is a ds_map which represents a <strong>textbox</strong>.<br>The conversation contains all variables listed under <a href="#Bultintextvariables">builtin variables</a> as a key. The textbox also contains most of this variables as keys. In the script <code>text_setup</code> under <strong>TEXT ENGINE VARIABLES</strong> you can find a list of variables that get copied to the textbox when it is created. Those variables only get copied on creation, that’s why changing <em>display</em> after creating a textbox doesn’t affect existing textboxes.<br>Each textbox contains a key called <em>__lines</em> which contains a list of all <strong>lines and nolines</strong>.  </p><p>Textboxes, nolines and lines and conversations also contain specific internal variables as keys. These are listed under “<a href="#builtinvariables">Builtin internal variables</a>“ and you can extend them and the normal text variables as explained under “<a href="#Ownvariables">9.3. Own variables</a>“.<br>More information on how the textvars variable is built up can be found under “<a href="#textvars">Reference: textvars diagram</a>“.</p><p>Okay. So now let’s start adding commands. The commands are split up into general logic and animation logic.<br>The general logic is stored under <strong>scripts/Text Engine/step/commands - logic</strong> as a script with the name <strong>text_command_logic_c_{NAME}</strong> with <strong>{NAME}</strong> being the name of your project.<br>Animation logic is stored under <strong>scripts/Text Engine/step/commands - animation logic</strong> as a script with the name <strong>text_command_animation_c_{NAME}</strong>. Both are case sensitive.<br>The <strong>logic</strong> script is needed for your command, the animation script is optional. Both are identical, the difference is that only once animation script is executed per step, while multiple command logics can be run in one script. Once a command is over, the next command is processed immediately.</p><h3 id="simple-one-shot-command"><a name="simple-one-shot-command" href="#simple-one-shot-command"></a>Simple one-shot command</h3><p>Let’s start with a <strong>simple command that only executes something once using a simple logic script</strong>. Create the script file and add the following line:</p><pre><code class="gml hljs" data-origin="&lt;pre&gt;&lt;code class=&quot;gml&quot;&gt;text_update_logic_continue(argument0);
&lt;/code&gt;&lt;/pre&gt;">text_update_logic_continue(argument0);
</code></pre><p>This is the minimum requirement. You can now already start using your command. Of course it won’t do anything.<br>All your command does right now is mark it as being done and telling the engine to continue with the next command. When your command is done you have to call <code>text_update_logic_continue</code>, <strong>otherwise</strong> your logic code will get <strong>repeated endlessly</strong>.</p><p>The <strong>first argument of your command logic script</strong> is the current <strong>conversation</strong>. It’s a ds_map containing all text variables, internal conversation variables and textboxes. If you want to know what is in it, use the debugger to take a look inside.<br>The <strong>second argument</strong> is the <strong>current command</strong> as an <strong>array</strong>. The first entry is the name of your command, <strong>the second entry is the first argument for your command, the third is the second argument…</strong> The array can have a variable length so check how many arguments were passed into your script.</p><p>Let’s see what the <strong>set</strong> command does:</p><pre><code class="gml hljs" data-origin="&lt;pre&gt;&lt;code class=&quot;gml&quot;&gt;var conv = argument0;
var current_command = argument1;

if (array_length_1d(current_command) &amp;lt; 3) {
    //Log an error and continue with the next command
    text_update_logic_continue(conv);
    exit;
}

var variabl = current_command[1];
var setto = current_command[2];

//Set the requested variable in the conversation to the requested value
ds_map_replace(conv,variabl,setto);

text_update_logic_continue(conv);
&lt;/code&gt;&lt;/pre&gt;">var conv = argument0;
var current_command = argument1;

if (array_length_1d(current_command) &lt; 3) {
    //Log an error and continue with the next command
    text_update_logic_continue(conv);
    exit;
}

var variabl = current_command[1];
var setto = current_command[2];

//Set the requested variable in the conversation to the requested value
ds_map_replace(conv,variabl,setto);

text_update_logic_continue(conv);
</code></pre><p>The rest is up to you. Change whatever variable you want or do something elese. With one-shot commands you probably want your own variables or internal variables. See chapter <a href="#Ownvariables">9.4.</a> for that.</p><h3 id="command-that-get-repeated"><a name="command-that-get-repeated" href="#command-that-get-repeated"></a>Command that get repeated</h3><p>If you want to repeat a command until an experssion is true, you simply don’t call <code>text_update_logic_continue</code> at the end of your script unless an expression is true. You can for example check a text variable, an internal text variable, a variable of an instance, a keypress, count something up, etc… You might want your own variables or internal variables. See chapter <a href="#Ownvariables">9.4.</a> for that.</p><h3 id="commands-that-get-executed-once-and-then-animate-something"><a name="commands-that-get-executed-once-and-then-animate-something" href="#commands-that-get-executed-once-and-then-animate-something"></a>Commands that get executed once and then animate something</h3><p>You basically combine the above situations for that and use a <strong>animation logic script</strong> for the animation. There is a special internal variable in the conversation map called <strong>__wait_for_animation</strong>. After your one-shot command was executed don’t call <code>text_update_logic_continue</code> and instead set this variable to true.<br>Put your whole one-shot command code into an if-statement that only executes the code when <strong>__wait_for_animation</strong> is false.<br>In your <strong>animation logic script</strong> put the logic that animates something using internal variables or variables (<a href="#Ownvariables">9.4.</a>). You propbaly want to graphically visualize that using <a href="#Owndisplaystyle">own display styles</a>. After the animation is done, set <strong>__wait_for_animation</strong> back to false and call  <code>text_update_logic_continue</code>.</p><h2 id="9-2-own-display-style"><a name="9-2-own-display-style" href="#9-2-own-display-style"></a><a name="Owndisplaystyle"></a>9.2. Own display style</h2><p>Before you can start adding display styles you need a basic understanding of how the engine works internally. This is described at the beginning of 9.1.</p><p>Display styles control how the textbox is drawn. So if you want to change the look of the texboxes beyond colors, you will need to create your own display styles.</p><h3 id="converting-coordinates"><a name="converting-coordinates" href="#converting-coordinates"></a>Converting coordinates</h3><p>The text engine is usually placed on it’s own surface. The following functions will help you to draw something:</p><ul>
<li><code>text_get_surface_w</code> - get the width of the surface - This is also the right corner of the screen usually</li>
<li><code>text_get_surface_w</code> - get the height of the surface - This is also the bottom corner of the screen usually</li>
<li><code>text_room_to_surface_x</code> - This converts any coordinate in the room to a coordinate on the text surface. If you use this with the x coordinate of an instance, this will draw something at the point where this instance is. If the instance is not on the screen the position returned by this function will be off the surface (which is no problem)</li>
<li><code>text_room_to_surface_y</code> - Same for the y coordinate</li>
</ul><h3 id="creating-the-display-style-scripts"><a name="creating-the-display-style-scripts" href="#creating-the-display-style-scripts"></a>Creating the display style scripts</h3><p>Each display style has it’s own folder in <strong>scripts/Text Engine/drawing/displaystyles</strong>. Simply add a new folder with the name of your display style.</p><p>When the textboxes are drawn, a set of script is executed for each display style. The scripts are (replace <strong>{NAME}</strong> with the name of your display style:</p><ul>
<li><strong>text_draw_c_{NAME}_metadata</strong> - Returns some font and text positioning metadata as an array, used by the <code>text_draw_text</code></li>
<li><strong>text_draw_c_{NAME}_enlargement</strong> - This get’s called actually called during the animation. This can be used to enlarge the textbox depending on how much text is in it.</li>
<li><strong>text_draw_c_{NAME}_position_manual</strong> - Set’s the x and y position of the textbox when in manual mode</li>
<li><strong>text_draw_c_{NAME}_position_auto</strong> - Same for automatic placement</li>
<li><strong>text_draw_c_{NAME}_name</strong> - Draws the nameplate if enabled</li>
<li><strong>text_draw_c_{NAME}_background</strong> - Draws the actual textbox</li>
<li><strong>text_draw_c_{NAME}_textnext</strong> - Draws the textnext sprite if given</li>
<li><strong>text_draw_c_{NAME}_extra</strong> - Draws additional stuff</li>
</ul><p>Create all scripts and follow the insturctions. <strong>If you need addiotnal help with any of these scripts, have a look at the banner scripts</strong></p><p>Before we can explain the different scripts, one important thing to know:<br>The textbox ds_map contains four special internal variable durding the drawing process.</p><ul>
<li><code>__draw_width</code> : The width of the textbox. This is by default the width specified in <code>get_metadat</code> but it might be changed by your <code>enlargement</code> script</li>
<li><code>__draw_height</code> : The same thing for the height</li>
<li><code>__draw_x</code> : The x position of the box. You have to set this with the <code>position_manual</code> and <code>position_auto</code> scripts [<strong><em>NOTE: THIS x-POSITION IS MEANT TO BE THE CENTER OF THE BOX</em></strong>]</li>
<li><code>__draw_y</code> :The same thing for the y position [<strong><em>NOTE: THIS y-POSITION IS MEANT TO BE THE CENTER OF THE BOX</em></strong>]</li>
</ul><p>You can add your own <strong>__draw_</strong> variables in the textbox ds_map to exchange variables between your drawing scripts.</p><h3 id="-text_draw_c_-name-_metadata-"><a name="-text_draw_c_-name-_metadata-" href="#-text_draw_c_-name-_metadata-"></a><code>text_draw_c_{NAME}_metadata</code></h3><p><em>Called during text drawing and textbox creation - no arguments</em></p><p>This script has to return an array with the following keys:</p><ul>
<li><strong>0</strong><br>If you want to use this display style to use a different version of a font use this to append a custom string to the fontname when drawing the text  You can for example make smaller versions for smaller displaystyles with that.<br>Otherwise just put an empty string into it</li>
<li><strong>1</strong><br>The offset the text is placed down from the top of the textbox</li>
<li><strong>2</strong><br>The offset at the left edge</li>
<li><strong>3</strong><br>Specify how high a single line is with your display style</li>
<li><strong>4</strong><br>Initial width of the textbox</li>
<li><strong>5</strong><br>Initial height of the textbox</li>
</ul><p>Example:</p><pre><code class="gml hljs" data-origin="&lt;pre&gt;&lt;code class=&quot;gml&quot;&gt;var ret;
ret[0] = &quot;&quot;;
ret[1] = 16;
ret[2] = 32;
ret[3] = 72;
ret[4] = 1260;
ret[5] = 1260/5;
return ret;
&lt;/code&gt;&lt;/pre&gt;">var ret;
ret[0] = "";
ret[1] = 16;
ret[2] = 32;
ret[3] = 72;
ret[4] = 1260;
ret[5] = 1260/5;
return ret;
</code></pre><h3 id="-text_draw_c_-name-_enlargement-"><a name="-text_draw_c_-name-_enlargement-" href="#-text_draw_c_-name-_enlargement-"></a><code>text_draw_c_{NAME}_enlargement</code></h3><p><em>argument0: textbox ds_map</em><br><em>argument1: Number of lines in this textbox</em><br><em>argument2: The width of the longest line in this textbox</em></p><p>Use this script to adjust the size of the textbox according to the text.<br>This is NOT called during the drawing event! Adjust the real width and height using the <code>__width</code> and <code>__height</code> intetnal variables.</p><p>Here’s a demo from the bubble display style:</p><pre><code class="gml hljs" data-origin="&lt;pre&gt;&lt;code class=&quot;gml&quot;&gt;var textbox = argument0;
var linecount = argument1;
var max_line_width = argument2;

var newheight = 32+36*(linecount+2);
var newwidth = 32+max_line_width;
if (textbox[? &quot;__height&quot;] &amp;lt; newheight) {
    textbox[? &quot;__height&quot;]+=10;
    if (textbox[? &quot;__height&quot;] &amp;gt; newheight) {
        textbox[? &quot;__height&quot;] = newheight;
    }
}
if (textbox[? &quot;__width&quot;] &amp;lt; newwidth) {
    textbox[? &quot;__width&quot;]+=10;
    if (textbox[? &quot;__width&quot;] &amp;gt; newwidth) {
        textbox[? &quot;__width&quot;] = newwidth;
    }
}
&lt;/code&gt;&lt;/pre&gt;">var textbox = argument0;
var linecount = argument1;
var max_line_width = argument2;

var newheight = 32+36*(linecount+2);
var newwidth = 32+max_line_width;
if (textbox[? "__height"] &lt; newheight) {
    textbox[? "__height"]+=10;
    if (textbox[? "__height"] &gt; newheight) {
        textbox[? "__height"] = newheight;
    }
}
if (textbox[? "__width"] &lt; newwidth) {
    textbox[? "__width"]+=10;
    if (textbox[? "__width"] &gt; newwidth) {
        textbox[? "__width"] = newwidth;
    }
}
</code></pre><p>This script is optional, you can also simply leave it blank.</p><h3 id="-text_draw_c_-name-_position_manual-"><a name="-text_draw_c_-name-_position_manual-" href="#-text_draw_c_-name-_position_manual-"></a><code>text_draw_c_{NAME}_position_manual</code></h3><p><em>Called as first script during the drawing process if manual mode is enabled - argument0 contains the textbox as a ds_map</em></p><p>This script has to set the x and y position of the textbox when using manual mode. Since this is manual mode, you usually want to place it at the x and y position specified with <em>manual_x</em> and <em>manual_y</em>.</p><p>The x and y position is set by changing the <strong>__draw_x</strong> and <strong>__draw_y</strong> variables in the textbox map.</p><p>Example:</p><pre><code class="gml hljs" data-origin="&lt;pre&gt;&lt;code class=&quot;gml&quot;&gt;var textbox = argument0;

textbox[? &quot;__draw_x&quot;] = textbox[? &quot;manual_x&quot;];
textbox[? &quot;__draw_y&quot;] = textbox[? &quot;manual_y&quot;]);
&lt;/code&gt;&lt;/pre&gt;">var textbox = argument0;

textbox[? "__draw_x"] = textbox[? "manual_x"];
textbox[? "__draw_y"] = textbox[? "manual_y"]);
</code></pre><p>You can also start drawing something in this script if you want to.</p><h3 id="-text_draw_c_-name-_position_auto-"><a name="-text_draw_c_-name-_position_auto-" href="#-text_draw_c_-name-_position_auto-"></a><code>text_draw_c_{NAME}_position_auto</code></h3><p><em>Called as first script during the drawing process if manual mode is disabled - argument0 contains the textbox as a ds_map</em></p><p>This script has to set the x and y position of the textbox when <strong>NOT</strong> using manual mode. You have to calculate a position.</p><p>The x and y position is set by changing the <strong>__draw_x</strong> and <strong>__draw_y</strong> variables in the textbox map.</p><p>You can also start drawing something in this script if you want to.</p><h3 id="-text_draw_c_-name-_name-"><a name="-text_draw_c_-name-_name-" href="#-text_draw_c_-name-_name-"></a><code>text_draw_c_{NAME}_name</code></h3><p><em>Called as second script during the drawing process if the nameplate is enabled - argument0 contains the textbox as a ds_map</em></p><p>This script should draw the nameplate. Remember that you can get width and height as well as x and y from the ds_map in argument0. (<code>__draw_x, __draw_y...</code>)</p><h3 id="-text_draw_c_-name-_background-"><a name="-text_draw_c_-name-_background-" href="#-text_draw_c_-name-_background-"></a><code>text_draw_c_{NAME}_background</code></h3><p><em>Called as  third script during the drawing process - argument0 contains the textbox as a ds_map</em></p><p>This script can draw whatever you want. This is usually the visual representation of the textbox.</p><h3 id="-text_draw_c_-name-_textnext-"><a name="-text_draw_c_-name-_textnext-" href="#-text_draw_c_-name-_textnext-"></a><code>text_draw_c_{NAME}_textnext</code></h3><p><em>Called as fourth script during the drawing process when a textnext sprite has to be drawn - argument0 contains the textbox as a ds_map</em></p><p>This script can use the internal variable <code>__textnext</code> to get the sprite id of the textnext sprite.</p><p>Example (banner):</p><pre><code class="gml hljs" data-origin="&lt;pre&gt;&lt;code class=&quot;gml&quot;&gt;var textbox = argument0;
//Setting local variables...
var Tx = textbox[? &quot;__draw_x&quot;];
var Ty = textbox[? &quot;__draw_y&quot;];
var Twidth = textbox[? &quot;__draw_width&quot;];
var Theight = textbox[? &quot;__draw_height&quot;];
draw_sprite_stretched(textbox[? &quot;__textnext&quot;],0,Tx+Twidth-100,Ty+Theight-80,48,48);
&lt;/code&gt;&lt;/pre&gt;">var textbox = argument0;
//Setting local variables...
var Tx = textbox[? "__draw_x"];
var Ty = textbox[? "__draw_y"];
var Twidth = textbox[? "__draw_width"];
var Theight = textbox[? "__draw_height"];
draw_sprite_stretched(textbox[? "__textnext"],0,Tx+Twidth-100,Ty+Theight-80,48,48);
</code></pre><h3 id="-text_draw_c_-name-_extra-"><a name="-text_draw_c_-name-_extra-" href="#-text_draw_c_-name-_extra-"></a><code>text_draw_c_{NAME}_extra</code></h3><p><em>Called as fifth script during the drawing process - argument0 contains the textbox as a ds_map</em></p><p>Here you can draw additional things. It is optional, you can also simply leave it blank.</p><h3 id="using-your-display-style"><a name="using-your-display-style" href="#using-your-display-style"></a>Using your display style</h3><p>Once you’ve set up all the scripts, you can use your display style by simply changing the <strong>display</strong> variable to the name of your display style.</p><h2 id="9-3-own-variables"><a name="9-3-own-variables" href="#9-3-own-variables"></a><a name="Ownvariables"></a>9.3. Own variables</h2><p>Before you can start adding your own text variables you need a basic understanding of how the engine works internally. This is described at the beginning of 9.1.</p><p>You can add your own text variables by adding them to <code>text_create_conversation</code> (See “<a href="#textvariabledefaults">Changing the defaults of text variables</a>“). If you want them to copy to textboxes or lines and nolines add them to <code>text_setup</code> after <strong>TEXT ENGINE VARIABLES</strong>.</p><p>Own internal variables can also be added that way. Please don’t copy internal variables to textboxes and lines.<br>Instead if you want textbox specific internal variables add them to <code>text_command_logic_c_show</code> after <code>//ADD YOUR OWN INTERNAL TEXTBOX VARIABLES HERE</code>.<br>For specific internal line variables add them to <code>text_command_logic_c_line</code>.</p><h2 id="9-4-reference-builtin-internal-variables"><a name="9-4-reference-builtin-internal-variables" href="#9-4-reference-builtin-internal-variables"></a><a name="builtinvariables"></a>9.4. Reference: Builtin internal variables</h2><p><strong><em>The following is a list of internal variables. Feel free to add your own for your commands or display styles. They should start with <strong> and you should use a prefix (after </strong>) for your own variables.</em></strong></p><h3 id="-player-"><a name="-player-" href="#-player-"></a><code>player</code></h3><p><strong>Description:</strong><br><em>This was originally not an internal variable that’s why it doesn’t start with __</em>.</p><p>An instance that controls this textbox. Always the local player for single player. Instance has to be in map <code>global.text_players</code>.</p><p><strong>Applies to:</strong><br>Whole conversation</p><p><strong>Default:</strong><br><code>global.text_local_player</code> (real/instance id)</p><p><strong>Valid values:</strong><br>a valid instance id placed in <code>global.text_players</code>.</p><h3 id="-__state-"><a name="-__state-" href="#-__state-"></a><code>__state</code></h3><p><strong>Description:</strong><br>The state of the conversation that can be retrieved with <code>text_get_state</code>. <strong>-1</strong> if running, <strong>1</strong> if finished.</p><p><strong>Do not change this variable.</strong></p><p><strong>Applies to:</strong><br>Whole conversation</p><p><strong>Default:</strong><br>-1 (real)</p><p><strong>Valid values:</strong><br>-1 or 1</p><h3 id="-__instance-"><a name="-__instance-" href="#-__instance-"></a><code>__instance</code></h3><p><strong>Description:</strong><br>The id of the instance that created this conversation as a string. Used for identification.</p><p><strong>Do not change this variable.</strong></p><p><strong>Applies to:</strong><br>Whole conversation</p><p><strong>Default:</strong><br><code>string(id)</code> (string/instance id)</p><p><strong>Valid values:</strong><br>a valid instance id as string</p><h3 id="-__commands-"><a name="-__commands-" href="#-__commands-"></a><code>__commands</code></h3><p><strong>Description:</strong><br>The ds_list that contains the commands.</p><p><strong>Applies to:</strong><br>Whole conversation</p><h3 id="-__wait_for_animation-"><a name="-__wait_for_animation-" href="#-__wait_for_animation-"></a><code>__wait_for_animation</code></h3><p><strong>Description:</strong><br>Used by commands to disable logic and only run animation logic. Use this variable for your own commands if you want. See below for a textbox variant of this variable. Use the textbox variant when possible.</p><p><strong>Applies to:</strong><br>Whole conversation</p><p><strong>Default:</strong><br>false (boolean)</p><p><strong>Valid values:</strong><br>false/true</p><h3 id="-__wait_time-"><a name="-__wait_time-" href="#-__wait_time-"></a><code>__wait_time</code></h3><p><strong>Description:</strong><br>The time when to continue with the script used by <code>wait_time</code>.</p><p><strong>Do not use this variable with other commands.</strong></p><p><strong>Valid values:</strong><br>real</p><h3 id="-__texts-"><a name="-__texts-" href="#-__texts-"></a><code>__texts</code></h3><p><strong>Description:</strong><br>The ds_list containing lines and nolines</p><h3 id="internal-variables-only-present-in-textboxes"><a name="internal-variables-only-present-in-textboxes" href="#internal-variables-only-present-in-textboxes"></a>Internal variables only present in textboxes</h3><p><strong><em>Add your own internal textbox variables in <code>text_command_logic_c_show</code></em></strong>.</p><h3 id="-__animatedchars-"><a name="-__animatedchars-" href="#-__animatedchars-"></a><code>__animatedchars</code></h3><p><strong>Description:</strong><br>The number of already animated characters. Maximum value is the number of all characters in all lines/nolines of this textbox.</p><p><strong>Default:</strong><br>0</p><p><strong>Valid values:</strong><br>All real values smaller or equal to the amount of characters in all lines or nolines that are not a newline (see the internal variables of lines for information on newlines)</p><h3 id="-__sumchars-"><a name="-__sumchars-" href="#-__sumchars-"></a><code>__sumchars</code></h3><p><strong>Description:</strong><br>The number of all characters in all lines/nolines that are not a newline (see the internal variables of lines for information on newlines)</p><p><strong>Do not change this variable unless you implement your own text parsing</strong></p><p><strong>Default:</strong><br>0</p><p><strong>Valid values:</strong><br><em>See description</em></p><h3 id="-__tmp_x-"><a name="-__tmp_x-" href="#-__tmp_x-"></a><code>__tmp_x</code></h3><p><strong>Description:</strong><br><em>Unused. Will be removed in an upcoming update</em></p><h3 id="-__tmp_y-"><a name="-__tmp_y-" href="#-__tmp_y-"></a><code>__tmp_y</code></h3><p><strong>Description:</strong><br><em>Unused. Will be removed in an upcoming update</em></p><h3 id="-__textnext-"><a name="-__textnext-" href="#-__textnext-"></a><code>__textnext</code></h3><p><strong>Description:</strong><br><em>Currently undocumented. Do not change.</em></p><h3 id="-__wait_for_animation-"><a name="-__wait_for_animation-" href="#-__wait_for_animation-"></a><code>__wait_for_animation</code></h3><p><strong>Description:</strong><br><em>Same as the internal variable found in the textbox. This is used for specific actions related to the textbox. You can use this instead of the conversation variant.</em></p><p><strong>Default:</strong><br>false (boolean)</p><p><strong>Valid values:</strong><br>false/true</p><h3 id="-__width-"><a name="-__width-" href="#-__width-"></a><code>__width</code></h3><p><strong>Description:</strong><br>The width of the textbox. This width is first retrieved from <code>text_draw_c_*_metadata</code> and may be expanded in <code>text_update_animation_autoenlargement</code> depending on how many characters are in this box.</p><p><strong>Default:</strong><br>a value depending on the display style retrieved from <code>ttext_draw_c_*_metadata</code>.</p><h3 id="-__height-"><a name="-__height-" href="#-__height-"></a><code>__height</code></h3><p><strong>Description:</strong><br>The height of the textbox. This height is first retrieved from <code>text_draw_c_*_metadata</code> and may be expanded in <code>text_update_animation_autoenlargement</code> depending on how many characters are in this box.</p><p><strong>Default:</strong><br>a value depending on the display style retrieved from <code>text_draw_c_*_metadata</code>.</p><p><strong>Valid values:</strong><br>false/true</p><h3 id="-__draw_x-"><a name="-__draw_x-" href="#-__draw_x-"></a><code>__draw_x</code></h3><p><strong>Description:</strong><br>The calculated x position of the textbox during drawing. Only used for temporary purposes during one draw. Do not use this to save anything between steps.</p><p><strong>Valid values:</strong><br>real</p><h3 id="-__draw_y-"><a name="-__draw_y-" href="#-__draw_y-"></a><code>__draw_y</code></h3><p><strong>Description:</strong><br>The calculated y position of the textbox during drawing. Only used for temporary purposes during one draw. Do not use this to save anything between steps.</p><p><strong>Valid values:</strong><br>real</p><h3 id="-__draw_width-"><a name="-__draw_width-" href="#-__draw_width-"></a><code>__draw_width</code></h3><p><strong>Description:</strong><br>The calculated width of the textbox during drawing. Only used for temporary purposes during one draw. Do not use this to save anything between steps.</p><p><strong>Valid values:</strong><br>real</p><h3 id="-__draw_height-"><a name="-__draw_height-" href="#-__draw_height-"></a><code>__draw_height</code></h3><p><strong>Description:</strong><br>The calculated height of the textbox during drawing. Only used for temporary purposes during one draw. Do not use this to save anything between steps.</p><p><strong>Valid values:</strong><br>real</p><h3 id="-__draw_-"><a name="-__draw_-" href="#-__draw_-"></a><code>__draw_****</code></h3><p><strong>Description:</strong><br>Other internal variables used by display styles. to pass values to other parts of the drawing. Only used for temporary purposes during one draw. Do not use this to save anything between steps.</p><h3 id="internal-variables-only-present-in-lines-and-nolines-"><a name="internal-variables-only-present-in-lines-and-nolines-" href="#internal-variables-only-present-in-lines-and-nolines-"></a>Internal variables only present in lines and nolines.</h3><p><strong><em>Add your own internal line variables in <code>text_command_logic_c_line</code></em></strong>.</p><p><strong>Previously we were not too clear about lines and nolines. Technically any line is a noline. There are special “newline” nolines that are not printed that contain the string <em>{NL}</em> as text (see text).</strong></p><h3 id="-text-"><a name="-text-" href="#-text-"></a><code>text</code></h3><p><strong>Description:</strong><br>The text stored in this noline. If this string is <strong>{NL}</strong> this noline is not printed and instead used as a newline marker. Using the text command <code>line</code> will always insert this special noline after a noline containing the text. For newlines the other internal variables and variables are not important and not reliable (they are not existing for those nolines).</p><p><strong>Valid values:</strong><br>string</p><h3 id="-__txt_width-"><a name="-__txt_width-" href="#-__txt_width-"></a><code>__txt_width</code></h3><p><strong>Description:</strong><br>Contains the width of the characters in this noline.<br><em>NOTE: This only gives you the length of this whole line if this is the only noline in this line, otherwise you have to add them up.</em></p><p><strong>Valid values:</strong><br>real</p><h3 id="-__height-"><a name="-__height-" href="#-__height-"></a><code>__height</code></h3><p><strong>Description:</strong><br><em>Currently undocumented.</em></p><h2 id="9-5-reference-textvars-diagram"><a name="9-5-reference-textvars-diagram" href="#9-5-reference-textvars-diagram"></a><a name="textvars"></a>9.5. Reference: textvars diagram</h2><p><strong><em>The following is a diagram that shows how the conversation ds_map global.textvars looks like. It does not contain every single variable and is only a brief overview.</em></strong></p><pre><code data-origin="&lt;pre&gt;&lt;code&gt;global.textvars =&amp;gt; ds_map
---&amp;gt;(&amp;lt;instance-id&amp;gt;-&amp;lt;num&amp;gt;) =&amp;gt; (a single conversation) ds_map
    ---&amp;gt;(variables)       =&amp;gt; See builtin variables
    ---&amp;gt;__instance        =&amp;gt; real, instance this is belonging to
    ---&amp;gt;__state           =&amp;gt; State
    ---&amp;gt;__commands        =&amp;gt; ds_list
        ---&amp;gt;(command)     =&amp;gt; array
            ---&amp;gt;[0]       =&amp;gt; (command) string
            ---&amp;gt;[1-15]    =&amp;gt; (arguments) real,string,bool
    ---&amp;gt;__texts           =&amp;gt; (aka. textboxes) ds_list
        -&amp;gt;(copied variables)=&amp;gt;See builtin variables
        ---&amp;gt;__height      =&amp;gt; height of the textbox
        ---&amp;gt;__width       =&amp;gt; width of the textbox
        ---&amp;gt;__lines       =&amp;gt; (lines) ds_list
            ---&amp;gt;[n]       =&amp;gt; ds_map
                ---&amp;gt;text  =&amp;gt; string (if text={NL} =&amp;gt; This line is a newline)
                ---&amp;gt;bold  =&amp;gt; bool
                ---&amp;gt;italic=&amp;gt; bool
                ---&amp;gt;color =&amp;gt; string
                ---&amp;gt;font  =&amp;gt; string
                -&amp;gt;__height=&amp;gt; See internal variables
&lt;/code&gt;&lt;/pre&gt;">global.textvars =&gt; ds_map
---&gt;(&lt;instance-id&gt;-&lt;num&gt;) =&gt; (a single conversation) ds_map
    ---&gt;(variables)       =&gt; See builtin variables
    ---&gt;__instance        =&gt; real, instance this is belonging to
    ---&gt;__state           =&gt; State
    ---&gt;__commands        =&gt; ds_list
        ---&gt;(command)     =&gt; array
            ---&gt;[0]       =&gt; (command) string
            ---&gt;[1-15]    =&gt; (arguments) real,string,bool
    ---&gt;__texts           =&gt; (aka. textboxes) ds_list
        -&gt;(copied variables)=&gt;See builtin variables
        ---&gt;__height      =&gt; height of the textbox
        ---&gt;__width       =&gt; width of the textbox
        ---&gt;__lines       =&gt; (lines) ds_list
            ---&gt;[n]       =&gt; ds_map
                ---&gt;text  =&gt; string (if text={NL} =&gt; This line is a newline)
                ---&gt;bold  =&gt; bool
                ---&gt;italic=&gt; bool
                ---&gt;color =&gt; string
                ---&gt;font  =&gt; string
                -&gt;__height=&gt; See internal variables
</code></pre><h2 id="9-6-debugging"><a name="9-6-debugging" href="#9-6-debugging"></a><a name="Debugging"></a>9.6. Debugging</h2><p><em>This section will be added in an upcoming update</em></p><h1 id="10-common-issues"><a name="10-common-issues" href="#10-common-issues"></a><a name="Issues"></a>10. Common issues</h1><h2 id="10-1-supported-platforms"><a name="10-1-supported-platforms" href="#10-1-supported-platforms"></a>10.1. Supported platforms</h2><p>Officially supported are <strong>Windows</strong>, <strong>Linux</strong> and <strong>Android</strong>. The engine <strong>should work on all platforms except HTML5</strong>.</p><p>On HTML5 <code>asset_get_index</code> currently doesn’t work. Because of this I am unable to port this engine to HTML5. There are also other issues on HTML5 that need to be fixed for this to be fully functional on HTML5.</p><h2 id="10-2-android-demo-project-controls-aren-t-working-correctly"><a name="10-2-android-demo-project-controls-aren-t-working-correctly" href="#10-2-android-demo-project-controls-aren-t-working-correctly"></a>10.2. Android: Demo project controls aren’t working correctly</h2><p>For some reasons the controls can stop working in the middle of the demo. Sorry for that, it has nothing to do with the engine! As you can see the demo is fully functional apart from that.</p><h2 id="10-3-linux-demo-project-strange-display-issue-when-starting-the-demo"><a name="10-3-linux-demo-project-strange-display-issue-when-starting-the-demo" href="#10-3-linux-demo-project-strange-display-issue-when-starting-the-demo"></a>10.3. Linux: Demo project: Strange display issue when starting the demo</h2><p>For some reason when starting the demo project on Linux the scaling of the game might be off. Try moving the window or scaling it. That fixed the issue for me. If you run into this problem in your own game please post a bug. Currently I’m pretty sure that has nothing to do with the text engine.</p><h2 id="10-4-i-m-getting-some-weird-error-when-starting-the-conversation"><a name="10-4-i-m-getting-some-weird-error-when-starting-the-conversation" href="#10-4-i-m-getting-some-weird-error-when-starting-the-conversation"></a>10.4. I’m getting some weird error when starting the conversation</h2><p>The engine is not fully debugged right now and might crash on errors. Take a look at in which script the error occurs and set the debug level to DEBUG. The error is most likely a misused text command or text variable.</p><p>If you can’t seem to find the error, post the conversation code in the issue tracker as a new bug with the description of your problem.</p><h1 id="11-issue-tracker-support"><a name="11-issue-tracker-support" href="#11-issue-tracker-support"></a><a name="Support"></a>11. Issue tracker / Support</h1><p>If you need support, please post a bug or feature request in our issue tracker at</p><p><strong><a href="https://bitbucket.org/happytear/happytear-text-engine/issues">https://bitbucket.org/happytear/happytear-text-engine/issues</a></strong></p><p>If you have anything to contribute (e.g. a bug fix) contact us via email:</p><p><strong>textengine@happytearstudios.com</strong> (if this email address is not functional use <strong>parakoopa@live.de</strong>)</p><p>We are planing to add a website where you can share your own extensions.<br>Until this is done, feel free to share them and even sell them as much as you want (even on the Marketplace if this is allowed).</p><p>Please note that while you are allowed to publish  your own version of the engine with your display styles and commands [since this is open source], it would be nice if you would not to that and only sell/share your extensions and link back to our marketplace entry! Thanks!</p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
